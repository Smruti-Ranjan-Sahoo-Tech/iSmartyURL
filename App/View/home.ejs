<!DOCTYPE html>
<html lang="en" class="dark">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>iSmarty URL</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
</head>

<body
  class="min-h-screen bg-white text-black dark:bg-neutral-950 dark:text-white flex flex-col transition-colors duration-300">

  <!-- Navbar -->
  <nav
    class="w-full border-b border-gray-200 dark:border-neutral-800 bg-white/80 dark:bg-neutral-950/80 backdrop-blur-lg fixed top-0 left-0 z-50 transition-colors duration-300">
    <div class="max-w-6xl mx-auto px-6 py-4 flex justify-between items-center">
      <h1 class="text-2xl font-extrabold tracking-tight hover:animate-pulse">iSmarty URL</h1>
      <div class="flex space-x-6 text-gray-600 dark:text-neutral-400 text-sm font-medium">
        <a href="https://github.com/Smruti-Ranjan-Sahoo-Tech" class="hover:text-black dark:hover:text-white transition">
          <img class="transition size-5 hover:animate-spin dark:hover:shadow-lg dark:hover:shadow-gray-700  dark:border dark:border-white  rounded-md dark:bg-white" src="https://cdn-icons-png.flaticon.com/512/3291/3291695.png" alt="">
        </a>
        <a href="https://www.linkedin.com/in/smruti-ranjan-sahood20040711/" class="hover:text-black dark:hover:text-white transition">
          <img class="transition size-5 hover:animate-spin dark:hover:shadow-lg dark:hover:shadow-gray-700  dark:border dark:border-white  rounded-md dark:bg-white" src="https://cdn-icons-png.flaticon.com/512/14715/14715341.png" alt="">
        </a>
        <a href="https://www.instagram.com/rajaismart?igsh=eWkwb2Q0Z3czM25v" class="hover:text-black dark:hover:text-white transition">
          <img class="transition size-5 hover:animate-spin dark:hover:shadow-lg dark:hover:shadow-gray-700  dark:border dark:border-white  rounded-md dark:bg-white" src="https://cdn-icons-png.flaticon.com/512/1400/1400829.png" alt="">
        </a>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="flex-1 w-full max-w-6xl mx-auto px-6 pt-28 pb-16 grid grid-cols-1 md:grid-cols-2 gap-10">

    <!-- URL Section -->
    <form
      class="bg-gray-100 dark:bg-neutral-900 border border-gray-200 dark:border-neutral-800 rounded-2xl p-8 shadow-xl transition-colors duration-300"
      method="POST" action="/url/shorten">
      <h2 class="text-xl font-semibold mb-6">URL Shortener</h2>

      <!-- IMPORTANT: give the input a name for server-side handling -->
      <input id="longUrl" name="url" type="url" required placeholder="Paste your long URL..."
        class="w-full p-4 rounded-xl border border-gray-300 dark:border-neutral-700 bg-white dark:bg-neutral-950 text-black dark:text-white placeholder-gray-500 dark:placeholder-neutral-500 focus:ring-2 focus:ring-black dark:focus:ring-white focus:outline-none mb-4 transition-colors duration-300" />

      <button type="submit"
        class="w-full py-3 rounded-xl bg-black dark:bg-white text-white dark:text-black font-semibold shadow hover:opacity-90 transition">
        Shorten URL
      </button>

      <!-- Rendered only when server sets data.shortUrl (keeps it hidden until shorten happens) -->
      <% if (typeof data !=='undefined' && data && data.shortUrl) { %>
        <div
          class="mt-6 p-4 bg-green-100 dark:bg-green-900/40 border border-green-300 dark:border-green-700 rounded-xl flex items-center justify-between gap-3">
          <a href="<%= data.shortUrl %>" target="_blank" rel="noopener noreferrer"
            class="text-green-700 dark:text-green-400 font-medium truncate">
            <%= data.shortUrl %>
          </a>

          <!-- Copy is triggered directly by a user click (gesture) -->
          <button type="button" onclick="copyToClipboard('<%= data.shortUrl %>')"
            class="px-3 py-1 rounded-lg bg-green-600 text-white text-sm font-semibold hover:bg-green-700 transition">
            Copy
          </button>
        </div>
        <% } %>
    </form>

    <!-- Contact Section -->
    <form action="https://api.web3forms.com/submit" method="POST"
      class="bg-gray-100 dark:bg-neutral-900 border border-gray-200 dark:border-neutral-800 rounded-2xl p-8 shadow-xl transition-colors duration-300">

      <h2 class="text-xl font-semibold mb-6">Contact Me</h2>
      <input type="hidden" name="access_key" value="749ccedc-e439-491c-89c2-7bc8aa1b0d93" />

      <input type="text" name="name" placeholder="Your Name" required
        class="w-full mb-3 p-4 rounded-xl border border-gray-300 dark:border-neutral-700 bg-white dark:bg-neutral-950 text-black dark:text-white placeholder-gray-500 dark:placeholder-neutral-500 focus:ring-2 focus:ring-black dark:focus:ring-white focus:outline-none" />

      <input type="email" name="email" placeholder="Your Email" required
        class="w-full mb-3 p-4 rounded-xl border border-gray-300 dark:border-neutral-700 bg-white dark:bg-neutral-950 text-black dark:text-white placeholder-gray-500 dark:placeholder-neutral-500 focus:ring-2 focus:ring-black dark:focus:ring-white focus:outline-none" />

      <textarea name="message" placeholder="Your Message..." rows="4" required
        class="w-full mb-3 p-4 rounded-xl border border-gray-300 dark:border-neutral-700 bg-white dark:bg-neutral-950 text-black dark:text-white placeholder-gray-500 dark:placeholder-neutral-500 focus:ring-2 focus:ring-black dark:focus:ring-white focus:outline-none"></textarea>

      <input type="checkbox" name="botcheck" class="hidden" style="display:none;" />
      <button type="submit"
        class="w-full py-3 rounded-xl bg-black dark:bg-white text-white dark:text-black font-semibold shadow hover:opacity-90 transition">
        Send Message
      </button>
    </form>
  </main>

  <!-- Footer -->
  <footer
    class="w-full border-t border-gray-200 dark:border-neutral-800 py-6 text-center text-gray-600 dark:text-neutral-500 text-sm transition-colors duration-300">
    © 2025 iSmarty URL · Crafted with passion
  </footer>

  <!-- Toast -->
  <div id="toast"
    class="fixed bottom-6 left-1/2 -translate-x-1/2 px-4 py-2 rounded-lg bg-black/80 text-white text-sm shadow-lg opacity-0 pointer-events-none transition-opacity">
  </div>

  <script>

    function showToast(msg, ms = 1500) {
      const t = document.getElementById('toast');
      t.textContent = msg;
      t.classList.remove('opacity-0');
      t.classList.add('opacity-100');
      setTimeout(() => {
        t.classList.remove('opacity-100');
        t.classList.add('opacity-0');
      }, ms);
    }

    // Robust copy: try modern Clipboard API; if blocked by permissions policy, fall back to execCommand
    async function copyToClipboard(text) {
      if (!text) { showToast('No URL to copy'); return; }

      if (navigator.clipboard && window.isSecureContext) {
        try {
          await navigator.clipboard.writeText(text);
          showToast('Copied to clipboard');
          return;
        } catch (err) {
          // Policy blocked or other issue – use fallback
          legacyCopy(text);
          return;
        }
      }
      // Not secure context or API missing
      legacyCopy(text);
    }

    function legacyCopy(text) {
      const ta = document.createElement('textarea');
      ta.value = text;
      ta.setAttribute('readonly', '');
      ta.style.position = 'fixed';
      ta.style.top = '-1000px';
      ta.style.opacity = '0';
      document.body.appendChild(ta);

      ta.focus();
      ta.select();
      ta.setSelectionRange(0, ta.value.length);

      let ok = false;
      try { ok = document.execCommand('copy'); } catch (e) { ok = false; }
      document.body.removeChild(ta);

      if (ok) {
        showToast('Copied to clipboard');
      } else {
        // Very restricted sandbox: last resort prompt
        const _ = window.prompt('Copy this URL:', text);
      }
    }
  </script>
</body>

</html>